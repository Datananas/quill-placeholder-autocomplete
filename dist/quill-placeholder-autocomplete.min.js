!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("quill")):"function"==typeof define&&define.amd?define(["quill"],t):"object"==typeof exports?exports.QuillPlaceholderAutocomplete=t(require("quill")):e.QuillPlaceholderAutocomplete=t(e.Quill)}("undefined"!=typeof self?self:this,function(e){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){n(1),e.exports=n(5)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(2);var r=i.Quill.import("delta"),s=function(){function e(t,n){var o=n.onClose,r=n.onOpen,s=n.getPlaceholders,l=n.container;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.quill=t,this.onClose=o,this.onOpen=r,this.getPlaceholders=s,"string"==typeof l?this.container=this.quill.container.parentNode.querySelector(l):void 0===l?(this.container=(0,i.h)("ul",{}),this.quill.container.parentNode.appendChild(this.container)):this.container=l,this.container.classList.add("ql-autocomplete-menu","completions"),this.container.style.position="absolute",this.container.style.display="none",this.onSelectionChange=this.maybeUnfocus.bind(this),this.onTextChange=this.update.bind(this),this.open=!1,this.quill.suggestsDialogOpen=!1,this.hashIndex=null,this.focusedButton=null,this.buttons=[],this.placeholders=[],t.keyboard.addBinding({key:51,altKey:!0},this.onHashKey.bind(this)),t.keyboard.addBinding({key:40,collapsed:!0,format:["suggest"]},this.handleArrow.bind(this)),t.keyboard.addBinding({key:27,collapsed:null,format:["suggest"]},this.handleEscape.bind(this)),t.mentionHandler=this.handleEnterTab.bind(this)}return o(e,[{key:"onHashKey",value:function(e,t){if(this.open)return!0;e.length>0&&this.quill.deleteText(e.index,e.length,i.Quill.sources.USER),this.quill.insertText(e.index,"#","suggest","@@placeholder",i.Quill.sources.USER);var n=this.quill.getBounds(e.index);this.quill.setSelection(e.index+1,i.Quill.sources.SILENT),this.hashIndex=e.index,this.container.style.left=n.left+"px",this.container.style.top=n.top+n.height+"px",this.open=!0,this.quill.suggestsDialogOpen=!0,this.quill.on("text-change",this.onTextChange),this.quill.once("selection-change",this.onSelectionChange),this.update(),this.onOpen&&this.onOpen()}},{key:"handleArrow",value:function(){if(!this.open)return!0;this.buttons[0].focus()}},{key:"handleEnterTab",value:function(){if(!this.open)return!0;this.close(this.placeholders[0])}},{key:"handleEscape",value:function(){if(!this.open)return!0;this.close()}},{key:"emptyCompletionsContainer",value:function(){for(;this.container.firstChild;)this.container.removeChild(this.container.firstChild)}},{key:"update",value:function(){var e=this,t=this.quill.getSelection().index;if(this.hashIndex>=t)return this.close(null);this.originalQuery=this.quill.getText(this.hashIndex+1,t-this.hashIndex-1),this.query=this.originalQuery.toLowerCase(),this.placeholders=this.getPlaceholders().filter(function(t){return t.label.toLowerCase().startsWith(e.query)}).sort(function(e,t){return e.label>t.label}),this.renderCompletions(this.placeholders)}},{key:"maybeUnfocus",value:function(){this.container.querySelector("*:focus")||this.close(null)}},{key:"renderCompletions",value:function(e){var t=this;this.emptyCompletionsContainer();var n=Array(e.length);this.buttons=n;e.forEach(function(e,o){var r,s,l=(0,i.h)("li",{},(0,i.h)("button",{type:"button"},(0,i.h)("span",{className:"matched"},"#"+e.label.slice(0,t.query.length)),(0,i.h)("span",{className:"unmatched"},e.label.slice(t.query.length))));t.container.appendChild(l),n[o]=l.firstChild,n[o].addEventListener("keydown",(r=o,s=e,function(e){"ArrowDown"===e.key||40===e.keyCode?(e.preventDefault(),n[Math.min(n.length-1,r+1)].focus()):"ArrowUp"===e.key||38===e.keyCode?(e.preventDefault(),n[Math.max(0,r-1)].focus()):"Enter"===e.key||13===e.keyCode||" "===e.key||32===e.keyCode||"Tab"===e.key||9===e.keyCode?(e.preventDefault(),t.close(s)):"Escape"!==e.key&&27!==e.keyCode||(e.preventDefault(),t.close())})),n[o].addEventListener("mousedown",function(){return t.close(e)}),n[o].addEventListener("focus",function(){return t.focusedButton=o}),n[o].addEventListener("unfocus",function(){return t.focusedButton=null})}),this.container.style.display="block"}},{key:"close",value:function(e){this.container.style.display="none",this.emptyCompletionsContainer(),this.quill.off("selection-change",this.onSelectionChange),this.quill.off("text-change",this.onTextChange);var t=(new r).retain(this.hashIndex).delete(this.query.length+1);this.quill.updateContents(t,i.Quill.sources.USER),e&&(this.quill.insertEmbed(this.hashIndex,"placeholder",e,i.Quill.sources.USER),this.quill.setSelection(this.hashIndex+1,0,i.Quill.sources.SILENT)),this.quill.focus(),this.open=!1,this.quill.suggestsDialogOpen=!1,this.onClose&&this.onClose(e||null)}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3);Object.defineProperty(t,"Quill",{enumerable:!0,get:function(){return o.Quill}});t.h=function(e,t){for(var n=arguments.length,o=Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];var r=document.createElement(e);return Object.keys(t).forEach(function(e){return r[e]=t[e]}),o.forEach(function(e){"string"==typeof e&&(e=document.createTextNode(e)),r.appendChild(e)}),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Quill=t.SuggestBlot=void 0;var o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function e(t,n,o){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,o)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(o):void 0},s=n(4),l=(o=s)&&o.__esModule?o:{default:o};var u=l.default.import("blots/inline"),a=t.SuggestBlot=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u),i(t,[{key:"format",value:function(e,n){"suggest"===e&&n?this.domNode.setAttribute("data-id",n):r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"format",this).call(this,e,n)}},{key:"formats",value:function(){var e=r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"formats",this).call(this);return e.suggest=t.formats(this.domNode),e}}],[{key:"create",value:function(e){var n=r(t.__proto__||Object.getPrototypeOf(t),"create",this).call(this);return n.dataset.id=e,n}},{key:"formats",value:function(e){return e.dataset.id}}]),t}();a.blotName="suggest",a.tagName="SPAN",a.className="suggest",l.default.register({"formats/suggest":a}),t.Quill=l.default},function(t,n){t.exports=e},function(e,t){}]).default});